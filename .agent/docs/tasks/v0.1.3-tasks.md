# v0.1.3 Tasks — Technical Debt & Follow-ups

## Goal
Address technical debt and finish incomplete implementation TODOs discovered during v0.1.2 work.

## Tasks

- **Repository / API TODOs**
  - [x] Implement Cloudflare Workers API calls in `app/composables/useAuth.ts` (owner: @kai, estimate: 2d) — Completed in PR #16
  - [x] Implement missing repository/store API calls for tags and recipes (`app/stores/data/*`) (owner: @kai, estimate: 3d) — Implemented; tests added

- **UI / UX**
  - [x] Implement global loading states in `app/stores/pages/recipes.ts` (owner: @kai, estimate: 1d) — Implemented via `app/stores/ui.ts`
  - [x] Integrate NuxtUI toasts in `app/composables/useAppToast.ts` (owner: @kai, estimate: 1d) — Implemented with unit tests and runtime test-friendly fallback
  - [ ] Add confirmation dialog where TODO present in `app/pages/index.vue` (owner: TBD, estimate: 1d)
  - [x] Suppress unresolved `@nuxt/ui` component warnings in dev/tests by adding lightweight stubs and ensuring layout usage (owner: @kai, estimate: 0.5d) — Implemented: `plugins/00-nuxt-ui-stubs.ts`, `plugins/nuxt-ui-stubs.ts`, `tests/setup.ts`, updated `app/app.vue`/`app/layouts/default.vue`.
  - [x] Restore `UForm`-based login form and make `onSubmit` accept UForm emit or native state (owner: @kai, estimate: 0.5d) — Implemented in `app/pages/auth/login.vue`.

- **Maintenance**
  - [ ] Triage and convert remaining `TODO` comments into Issues with owners and estimates (owner: @kai, estimate: 1d)
  - [ ] Schedule follow-up sprint for v0.1.3 and set target dates (owner: @kai, estimate: 0.5d)

- **Current v0.1.3 work items (updated)**
  - [ ] Scan completed: TODOs cataloged in `.agent/docs/tasks/v0.1.3-issues.md` (owner: @kai) — Next: create GH issues
  - [ ] Implement confirmation dialog in `app/pages/index.vue` (owner: @kai, estimate: 0.5d) — Priority: P1
  - [ ] Implement `app/repositories/tags.ts` and `app/repositories/recipes.ts` CRUD/pagination (owner: @kai, estimate: 2d) — Priority: P2
  - [ ] Update `store/data/*` and `store/pages/*` to new repository API (owner: TBD, estimate: 1d)
  - [ ] Finalize `useAuth` integration tests and edge-case handling (owner: @kai, estimate: 1d)
  - [ ] Implement `useLogger` adapter (owner: @kai, estimate: 0.5d)
  - [ ] Add unit/integration/a11y tests for changed areas (owner: PR author, estimate: 1.5d)

## Acceptance criteria
- Each code change has unit and/or integration tests where applicable
- Accessibility (axe) tests added/updated for UI changes
- `.agent/specs/*` and `CHANGELOG.md` updated with summary of v0.1.3 changes
- All PRs pass CI (lint/typecheck/tests)

## Recent activity (v0.1.3)

- Implemented UI stubs to avoid unresolved-component warnings in dev and test environments; tests pass locally (`pnpm lint && pnpm typecheck && pnpm test`).
- Restored login form to use `UForm` and fixed `onSubmit` behavior to support emitted payloads and native state validation.
- Updated `.agent/specs/ui-stubs.md` and added QA entry `.agent/docs/qa/v0.1.3-qa.md` to document the decision and rationale.
- Updated `CHANGELOG.md` with v0.1.3 notes and committed changes on branch `release/v0.1.3`.

## Next steps

Plan: Implement missing repository/store API calls for tags and recipes

- Step 1 — トリアージ: `app/stores/data` と `app/repositories` 内の TODO を洗い出し、Issue に変換してオーナーと見積を付与する（担当: @kai, 0.5d）。
- Step 2 — 仕様作成: 必要な API 引数・戻り値・エラー型を決めて `.agent/specs/repository-api.md`（または適切な specs）を更新する（担当: @kai, 0.5d）。
- Step 3 — リポジトリ実装: `tags`/`recipes` の create/update/delete/pagination 等を `app/repositories/*` に実装し、unit テストを追加する（担当: @kai, 2d）。
- Step 4 — データ/ページストア適用: `store/data/*` と `store/pages/*` を新しいリポジトリ API に合わせて更新、Page Store の統合テストを追加する（担当: TBD, 1d）。
- Step 5 — 統合/アクセシビリティ: 必要に応じて integration/E2E と axe a11y テストを追加する（担当: TBD, 1d）。
- Step 6 — ドキュメントとリリース準備: `.agent/specs/*` と `CHANGELOG.md` を更新し、PR を作成して CI を通す（担当: @kai, 0.5d）。

このプランで進めてよければ、まず Step 1 のトリアージ（TODO→Issue 化）を進めます。詳細が必要なら指示ください。


## Timeline
- Target: v0.1.3 (next sprint)

## Work items (canonical)

The following items are the canonical work items for v0.1.3. Progress and ownership are tracked below.

- [ ] Confirmation dialog in `app/pages/index.vue` — Owner: @kai — Estimate: 1d — Priority: P1
- [ ] `useAuth.ts` Cloudflare Workers API integration — Owner: @kai — Estimate: 1.5d — Priority: P2
- [ ] Repositories & Stores (tags/recipes) — Owner: @kai — Estimate: 2d — Priority: P3
- [ ] Tech-debt sweep: convert remaining TODOs to issues — Owner: @kai — Estimate: 0.5d — Priority: P4

Notes:
- Work starts with Priority 1 and progresses sequentially unless blocked.
- All changes must include tests and corresponding `.agent/specs/*` updates when behavior changes.

## Completed
- **Auth integration**: Cloudflare Workers calls implemented in `app/composables/useAuth.ts`, unit tests added, and `.agent/specs/auth.md` updated (PR #16 merged).

## Issue candidates (draft)

以下は残タスクを GitHub Issue 化するための草案です。Issue 作成時に担当者・正確な見積りを追加してください。

- **CI: 未解決の lint/typecheck エラーを解決して CI を安定化する**
  - 優先度: P1
  - 見積: M
  - ラベル候補: `area:ci`, `priority:P1`

- **TODO コメントの全件一覧化と Issue 化**
  - 優先度: P1
  - 見積: M
  - ラベル候補: `docs`, `area:tech-debt`

- **ステージC: 認証フロー最終調整 + 追加 E2E テスト**
  - 優先度: P1
  - 見積: M
  - ラベル候補: `area:auth`, `tests`

- **ステージC-2 (optional): Miniflare を用いた Workers-like E2E の CI 実行**
  - 優先度: P2
  - 見積: M
  - ラベル候補: `area:ci`, `area:testing`

- **ステージD: ユニット／統合／a11y テスト実行と修正**
  - 優先度: P1
  - 見積: L
  - ラベル候補: `tests`, `a11y`

- **ステージG: PR 作成・レビュー対応（specs 同梱）**
  - 優先度: P1
  - 見積: S
  - ラベル候補: `pr`, `process`

- **ステージH: リリース（タグ作成・リリースノート発行）**
  - 優先度: P1
  - 見積: S
  - ラベル候補: `release`
