# v0.1.3 Tasks — Technical Debt & Follow-ups

## Goal
Address technical debt and finish incomplete implementation TODOs discovered during v0.1.2 work.

## Tasks

- **Repository / API TODOs**
  - [x] Implement Cloudflare Workers API calls in `app/composables/useAuth.ts` (owner: @kai, estimate: 2d) — Completed in PR #16
  - [x] Implement missing repository/store API calls for tags and recipes (`app/stores/data/*`) (owner: @kai, estimate: 3d) — Implemented; tests added

- **UI / UX**
  - [x] Implement global loading states in `app/stores/pages/recipes.ts` (owner: @kai, estimate: 1d) — Implemented via `app/stores/ui.ts`
  - [x] Integrate NuxtUI toasts in `app/composables/useAppToast.ts` (owner: @kai, estimate: 1d) — Implemented with unit tests and runtime test-friendly fallback
  - [x] Add confirmation dialog where TODO present in `app/pages/index.vue` (owner: TBD, estimate: 1d) — 完了
  - [x] Suppress unresolved `@nuxt/ui` component warnings in dev/tests by adding lightweight stubs and ensuring layout usage (owner: @kai, estimate: 0.5d) — Implemented
  - [x] Restore `UForm`-based login form and make `onSubmit` accept UForm emit or native state (owner: @kai, estimate: 0.5d) — Implemented in `app/pages/auth/login.vue`.

- **Maintenance**
  - [x] Triage and convert remaining `TODO` comments into Issues with owners and estimates (owner: @kai, estimate: 1d) — 完了
  - [ ] Schedule follow-up sprint for v0.1.3 and set target dates (owner: @kai, estimate: 0.5d)

- **Current v0.1.3 work items (updated)**
  - [x] Scan completed: TODOs cataloged in `.agent/docs/tasks/v0.1.3-issues.md` (owner: @kai) — 完了
  - [x] Implement confirmation dialog in `app/pages/index.vue` (owner: @kai, estimate: 0.5d) — Priority: P1
  - [x] Implement `app/repositories/tags.ts` and `app/repositories/recipes.ts` CRUD/pagination (owner: @kai, estimate: 2d) — Priority: P2 — 完了
  - [x] Update `store/data/*` and `store/pages/*` to new repository API (owner: TBD, estimate: 1d) — 完了
  - [x] Finalize `useAuth` integration tests and edge-case handling (owner: @kai, estimate: 1d)
  - [x] Implement `useLogger` adapter (owner: @kai, estimate: 0.5d)
  - [x] Add unit/integration/a11y tests for changed areas (owner: PR author, estimate: 1.5d) — 完了

## Acceptance criteria
- Each code change has unit and/or integration tests where applicable
- Accessibility (axe) tests added/updated for UI changes
- `.agent/specs/*` and `CHANGELOG.md` updated with summary of v0.1.3 changes
- All PRs pass CI (lint/typecheck/tests)

## Recent activity (v0.1.3)

- Implemented UI stubs to avoid unresolved-component warnings in dev and test environments; tests pass locally (`pnpm lint && pnpm typecheck && pnpm test`).
- Restored login form to use `UForm` and fixed `onSubmit` behavior to support emitted payloads and native state validation.
- Updated `.agent/specs/ui-stubs.md` and added QA entry `.agent/docs/qa/v0.1.3-qa.md` to document the decision and rationale.
- Updated `CHANGELOG.md` with v0.1.3 notes and committed changes on branch `release/v0.1.3`.

# v0.1.3 Tasks — Technical Debt & Follow-ups
  - [ ] Schedule follow-up sprint for v0.1.3 and set target dates (owner: @kai, estimate: 0.5d)

- **Current v0.1.3 work items (updated)**
  - [x] Scan completed: TODOs cataloged in `.agent/docs/tasks/v0.1.3-issues.md` (owner: @kai) — 完了
  - [x] Scan completed: TODOs cataloged in `.agent/docs/tasks/v0.1.3-issues.md` (owner: @kai) — 次: GH Issues 作成済み
  - [x] Implement confirmation dialog in `app/pages/index.vue` (owner: @kai, estimate: 0.5d) — Priority: P1
  - [ ] Implement `app/repositories/tags.ts` and `app/repositories/recipes.ts` CRUD/pagination (owner: @kai, estimate: 2d) — Priority: P2
   - [x] Implement `app/repositories/tags.ts` and `app/repositories/recipes.ts` CRUD/pagination (owner: @kai, estimate: 2d) — Priority: P2 — 完了
  - [ ] Update `store/data/*` and `store/pages/*` to new repository API (owner: TBD, estimate: 1d)
   - [x] Update `store/data/*` and `store/pages/*` to new repository API (owner: TBD, estimate: 1d) — 完了
  - [x] Finalize `useAuth` integration tests and edge-case handling (owner: @kai, estimate: 1d)
  - [x] Implement `useLogger` adapter (owner: @kai, estimate: 0.5d)
  - [ ] Add unit/integration/a11y tests for changed areas (owner: PR author, estimate: 1.5d)
   - [x] Add unit/integration/a11y tests for changed areas (owner: PR author, estimate: 1.5d) — 完了

## Acceptance criteria
- Each code change has unit and/or integration tests where applicable
- Accessibility (axe) tests added/updated for UI changes
- `.agent/specs/*` and `CHANGELOG.md` updated with summary of v0.1.3 changes
- All PRs pass CI (lint/typecheck/tests)

## Recent activity (v0.1.3)

- Implemented UI stubs to avoid unresolved-component warnings in dev and test environments; tests pass locally (`pnpm lint && pnpm typecheck && pnpm test`).
- Restored login form to use `UForm` and fixed `onSubmit` behavior to support emitted payloads and native state validation.
- Updated `.agent/specs/ui-stubs.md` and added QA entry `.agent/docs/qa/v0.1.3-qa.md` to document the decision and rationale.
- Updated `CHANGELOG.md` with v0.1.3 notes and committed changes on branch `release/v0.1.3`.

## Next steps

Plan: Implement missing repository/store API calls for tags and recipes

- Step 1 — トリアージ: `app/stores/data` と `app/repositories` 内の TODO を洗い出し、Issue に変換してオーナーと見積を付与する（担当: @kai, 0.5d）。
 - [x] Step 1 — トリアージ: `app/stores/data` と `app/repositories` 内の TODO を洗い出し、Issue に変換してオーナーと見積を付与する（担当: @kai, 0.5d） — 完了: GitHub Issues を作成済み（#20, #21, #22, #23, #24）
- Step 2 — 仕様作成: 必要な API 引数・戻り値・エラー型を決めて `.agent/specs/repository-api.md`（または適切な specs）を更新する（担当: @kai, 0.5d）。
- Step 3 — リポジトリ実装: `tags`/`recipes` の create/update/delete/pagination 等を `app/repositories/*` に実装し、unit テストを追加する（担当: @kai, 2d）。
- Step 4 — データ/ページストア適用: `store/data/*` と `store/pages/*` を新しいリポジトリ API に合わせて更新、Page Store の統合テストを追加する（担当: TBD, 1d）。
- Step 5 — 統合/アクセシビリティ: 必要に応じて integration/E2E と axe a11y テストを追加する（担当: TBD, 1d）。
- Step 6 — ドキュメントとリリース準備: `.agent/specs/*` と `CHANGELOG.md` を更新し、PR を作成して CI を通す（担当: @kai, 0.5d）。

### CI ログ確認結果とフォローアップ

- [x] CI ログ確認: `ci.yml` の直近実行ログを確認しました（`gh run view`）。結果: `Test Files 24 passed (24) / Tests 49 passed (49)` — 成功。
- [x] フォロー: `.github/scripts/check-specs.sh` に対する "Permission denied" が出ています。対応案: スクリプトに実行権限を付与してコミット（`chmod +x .github/scripts/check-specs.sh`）、もしくは workflow 内で `bash .github/scripts/check-specs.sh` と明示的に実行するように修正。（担当: @kai） — 対応済み

### リリース準備（短期優先）
- [x] PR #15 の最終レビューとマージ準備（`specs` と `CHANGELOG.md` の同梱を再確認）（担当: @kai） — 完了
- [ ] 作成した Issue にラベル・担当・見積りを付与（担当: @kai）

## Recent progress (updated)

- Stage D: ユニット／統合/a11y テストをローカルで実行し、全テストが成功しました（`Tests 49 passed (49)`）。Stage D を完了扱いとします。
- CI: GitHub Actions を workflow_dispatch でトリガーしました（branch: `release/v0.1.3`, `ci.yml`）。現状は `RUN_MINIFLARE=false` のデフォルトで実行しています。CI 実行状況は `gh run list --workflow="ci.yml"` で確認できます。


## Recent status (updated)

- CI workflow fixed and consolidated (`.github/workflows/ci.yml`). Key changes:
  - Duplicate workflow blocks merged, `RUN_MINIFLARE` handling added, and `paths-ignore` updated to skip only `.agent/**` changes.
  - Optional `miniflare-e2e` job added; runs when workflow input or repo Actions variable `RUN_MINIFLARE=true`.

- Tests executed locally:
  - `tests/integration/auth-refresh.spec.ts` — passed
  - `tests/integration/auth-refresh-workers.spec.ts` — passed
  - `tests/integration/auth-refresh-miniflare.spec.ts` — optional run/skipped when `miniflare` absent; OK

- Current focus: finalize Stage C (authentication polish) and prepare Stage D (full unit/integration/a11y pass) and PR prep.

## Next actions (short-term)

- Enable `RUN_MINIFLARE` in repository Actions variables to run Miniflare E2E in CI (optional).
- Convert remaining `TODO` comments to Issues and assign owners (see Issue candidates section).
- Prepare `release/v0.1.3` PR and include `.agent/specs/auth.md` and `CHANGELOG.md` updates.

このプランで進めてよければ、まず Step 1 のトリアージ（TODO→Issue 化）を進めます。詳細が必要なら指示ください。


## Timeline
- Target: v0.1.3 (next sprint)

## Work items (canonical)

The following items are the canonical work items for v0.1.3. Progress and ownership are tracked below.

- [ ] Confirmation dialog in `app/pages/index.vue` — Owner: @kai — Estimate: 1d — Priority: P1
- [ ] `useAuth.ts` Cloudflare Workers API integration — Owner: @kai — Estimate: 1.5d — Priority: P2
- [ ] Repositories & Stores (tags/recipes) — Owner: @kai — Estimate: 2d — Priority: P3
- [ ] Tech-debt sweep: convert remaining TODOs to issues — Owner: @kai — Estimate: 0.5d — Priority: P4

Notes:
- Work starts with Priority 1 and progresses sequentially unless blocked.
- All changes must include tests and corresponding `.agent/specs/*` updates when behavior changes.

## Completed
- **Auth integration**: Cloudflare Workers calls implemented in `app/composables/useAuth.ts`, unit tests added, and `.agent/specs/auth.md` updated (PR #16 merged).

## Issue candidates (draft)

以下は残タスクを GitHub Issue 化するための草案です。Issue 作成時に担当者・正確な見積りを追加してください。

- **CI: 未解決の lint/typecheck エラーを解決して CI を安定化する**
  - 優先度: P1
  - 見積: M
  - ラベル候補: `area:ci`, `priority:P1`

- **TODO コメントの全件一覧化と Issue 化**
  - 優先度: P1
  - 見積: M
  - ラベル候補: `docs`, `area:tech-debt`

- **ステージC: 認証フロー最終調整 + 追加 E2E テスト**
  - 優先度: P1
  - 見積: M
  - ラベル候補: `area:auth`, `tests`

- **ステージC-2 (optional): Miniflare を用いた Workers-like E2E の CI 実行**
  - 優先度: P2
  - 見積: M
  - ラベル候補: `area:ci`, `area:testing`

- **ステージD: ユニット／統合／a11y テスト実行と修正**
  - 優先度: P1
  - 見積: L
  - ラベル候補: `tests`, `a11y`

- **ステージG: PR 作成・レビュー対応（specs 同梱）**
  - 優先度: P1
  - 見積: S
  - ラベル候補: `pr`, `process`

- **ステージH: リリース（タグ作成・リリースノート発行）**
  - 優先度: P1
  - 見積: S
  - ラベル候補: `release`
